!function(e,t){"function"==typeof define&&define.amd?define(["./client.min.js"],t):"object"==typeof exports?module.exports=t(require("./client.min.js")):e.fingerprint2me=t(e.ClientJS)}("undefined"!=typeof self?self:this,(function(e){const t={errors:[],warnings:[],logError(e,t,n=null){const r={timestamp:(new Date).toISOString(),function:e,error:t.message||String(t),data:n,stack:t.stack};this.errors.push(r),"undefined"!=typeof window&&"localhost"===window.location?.hostname&&console.error(`[Fingerprint2Me] ${e}:`,t,n)},logWarning(e,t,n=null){const r={timestamp:(new Date).toISOString(),function:e,message:t,data:n};this.warnings.push(r),"undefined"!=typeof window&&"localhost"===window.location?.hostname&&console.warn(`[Fingerprint2Me] ${e}:`,t,n)},wrapAsync(e,t){return async(...n)=>{try{return await e(...n)}catch(e){return this.logError(t,e,{args:n}),{error:"function_failed",details:e.message}}}},wrap(e,t){return(...n)=>{try{return e(...n)}catch(e){return this.logError(t,e,{args:n}),{error:"function_failed",details:e.message}}}},getErrorSummary(){return{errorCount:this.errors.length,warningCount:this.warnings.length,recentErrors:this.errors.slice(-5),recentWarnings:this.warnings.slice(-5)}},clearLogs(){this.errors=[],this.warnings=[]}},n={cache:new Map,CACHE_DURATION:3e5,get(e){const t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.CACHE_DURATION?t.value:(this.cache.delete(e),null)},set(e,t){this.cache.set(e,{value:t,timestamp:Date.now()})},clear(){this.cache.clear()},getOrSet(e,t){const n=this.get(e);if(null!==n)return n;const r=t();return this.set(e,r),r},async getOrSetAsync(e,t){const n=this.get(e);if(null!==n)return n;const r=await t();return this.set(e,r),r}},r=(new Map,{consentGiven:!1,allowedTechniques:new Set(["basic"]),checkConsent(){try{const e=localStorage.getItem("fingerprint2me_consent");if(e){const t=JSON.parse(e);this.consentGiven=t.given,this.allowedTechniques=new Set(t.techniques||["basic"])}}catch(e){t.logError("PrivacyManager.checkConsent",e)}},giveConsent(e=["basic","advanced","network"]){try{this.consentGiven=!0,this.allowedTechniques=new Set(e),localStorage.setItem("fingerprint2me_consent",JSON.stringify({given:!0,techniques:e,timestamp:(new Date).toISOString()}))}catch(e){t.logError("PrivacyManager.giveConsent",e)}},revokeConsent(){try{this.consentGiven=!1,this.allowedTechniques=new Set(["basic"]),localStorage.removeItem("fingerprint2me_consent"),n.clear()}catch(e){t.logError("PrivacyManager.revokeConsent",e)}},isAllowed(e){return this.consentGiven?this.allowedTechniques.has(e):"basic"===e},getConsentStatus(){return{consentGiven:this.consentGiven,allowedTechniques:Array.from(this.allowedTechniques),timestamp:this.getConsentTimestamp()}},getConsentTimestamp(){try{const e=localStorage.getItem("fingerprint2me_consent");if(e){return JSON.parse(e).timestamp}}catch(e){t.logError("PrivacyManager.getConsentTimestamp",e)}return null}});function i(e,t=1e4){"string"!=typeof e&&(e=String(e));const n=e.replace(/[<>\"'&]/g,"");return n.length>t?n.substring(0,t):n}function o(e){try{const t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol}catch{return!1}}async function s(e){if(window.crypto&&window.crypto.subtle){const t=(new TextEncoder).encode(e),n=await window.crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("").substring(0,32)}return function(e){if(0===e.length)return"0".repeat(32);let t=0,n=0,r=0,i=0;for(let n=0;n<e.length;n++){t=(t<<5)+t+e.charCodeAt(n),t&=4294967295}for(let t=0;t<e.length;t++){n=e.charCodeAt(t)+(n<<6)+(n<<16)-n,n&=4294967295}for(let t=0;t<e.length;t++){r=(r<<5)-r+e.charCodeAt(t),r&=4294967295}const o=16777619;i=2166136261;for(let t=0;t<e.length;t++){i^=e.charCodeAt(t),i=i*o&4294967295}return Math.abs(t).toString(16).padStart(8,"0")+Math.abs(n).toString(16).padStart(8,"0")+Math.abs(r).toString(16).padStart(8,"0")+Math.abs(i).toString(16).padStart(8,"0")}(e)}function a(e){return e?e.split(",").map((e=>e.trim())).filter((e=>e&&e.length>0)).sort().join(", "):""}function c(){return new Promise((e=>{try{const t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(!t)return void e({error:"not_supported"});const n=new t({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});let r=[],i=0;n.onicecandidate=t=>{if(t.candidate){i++;const e=t.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/);e&&!r.includes(e[1])&&r.push(e[1])}else n.close(),e({localIPs:r,candidateCount:i})},n.createDataChannel(""),n.createOffer().then((e=>n.setLocalDescription(e))),setTimeout((()=>{n.close(),e({localIPs:r,candidateCount:i,timeout:!0})}),3e3)}catch(t){e({error:"error"})}}))}function g(){try{const e={};return["(prefers-color-scheme: dark)","(prefers-reduced-motion: reduce)","(prefers-contrast: high)","(prefers-transparency: reduce)","(forced-colors: active)","(hover: hover)","(any-hover: hover)","(pointer: fine)","(any-pointer: fine)","(display-mode: standalone)","(min-device-pixel-ratio: 2)","(color-gamut: srgb)","(color-gamut: p3)","(color-gamut: rec2020)"].forEach((t=>{e[t]=window.matchMedia(t).matches})),e}catch(e){return{error:"not_supported"}}}function u(){try{if(!navigator.getGamepads)return{error:"not_supported"};const e=navigator.getGamepads(),t=[];for(let n=0;n<e.length;n++)e[n]&&t.push({id:e[n].id,mapping:e[n].mapping,connected:e[n].connected,timestamp:e[n].timestamp});return{gamepads:t,length:e.length}}catch(e){return{error:"not_supported"}}}async function l(){try{return window.indexedDB?new Promise((e=>{const t="test_fingerprint_db",n=indexedDB.open(t,1);n.onerror=()=>e({error:"access_denied"}),n.onsuccess=()=>{const r=n.result,i={name:r.name,version:r.version,objectStoreNames:Array.from(r.objectStoreNames)};r.close(),indexedDB.deleteDatabase(t),e(i)},n.onupgradeneeded=e=>{e.target.result.createObjectStore("test",{keyPath:"id"})},setTimeout((()=>e({error:"timeout"})),1e3)})):{error:"not_supported"}}catch(e){return{error:"not_supported"}}}function p(){try{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e?{effectiveType:e.effectiveType,type:e.type,saveData:e.saveData}:{error:"not_supported"}}catch(e){return{error:"not_supported"}}}function d(){try{if(!window.speechSynthesis||!window.speechSynthesis.getVoices)return{error:"not_supported"};let e=window.speechSynthesis.getVoices();if(0===e.length){if(void 0!==window.speechSynthesis.onvoiceschanged)return{voicesLoaded:!1,speechSynthesisSupported:!0,voiceCount:0,placeholder:"voices_not_loaded"};e=window.speechSynthesis.getVoices()}if(0===e.length)return{voicesLoaded:!1,speechSynthesisSupported:!0,voiceCount:0,placeholder:"voices_not_loaded"};const t=e.map((e=>({name:e.name,lang:e.lang,localService:e.localService,default:e.default})));return{voicesLoaded:!0,speechSynthesisSupported:!0,voiceCount:e.length,voices:t,defaultVoice:e.find((e=>e.default))?.name||"none",localServiceCount:e.filter((e=>e.localService)).length,remoteServiceCount:e.filter((e=>!e.localService)).length,languageCount:new Set(e.map((e=>e.lang))).size,uniqueLanguages:Array.from(new Set(e.map((e=>e.lang)))).sort()}}catch(e){return{error:"not_supported"}}}function h(){try{if(!window.crypto)return{error:"not_supported"};const e={cryptoSupported:!0,subtleCrypto:!!window.crypto.subtle,getRandomValues:"function"==typeof window.crypto.getRandomValues,algorithms:[]};if(window.crypto.subtle){const t=["SHA-1","SHA-256","SHA-384","SHA-512","RSA-PSS","RSA-OAEP","RSASSA-PKCS1-v1_5","ECDSA","ECDH","AES-CTR","AES-CBC","AES-GCM","AES-KW","HMAC","PBKDF2","HKDF"];for(const n of t)try{("function"==typeof window.crypto.subtle.digest||"function"==typeof window.crypto.subtle.encrypt||"function"==typeof window.crypto.subtle.sign||"function"==typeof window.crypto.subtle.generateKey)&&e.algorithms.push(n)}catch(e){}e.methods={encrypt:"function"==typeof window.crypto.subtle.encrypt,decrypt:"function"==typeof window.crypto.subtle.decrypt,sign:"function"==typeof window.crypto.subtle.sign,verify:"function"==typeof window.crypto.subtle.verify,digest:"function"==typeof window.crypto.subtle.digest,generateKey:"function"==typeof window.crypto.subtle.generateKey,deriveKey:"function"==typeof window.crypto.subtle.deriveKey,deriveBits:"function"==typeof window.crypto.subtle.deriveBits,importKey:"function"==typeof window.crypto.subtle.importKey,exportKey:"function"==typeof window.crypto.subtle.exportKey,wrapKey:"function"==typeof window.crypto.subtle.wrapKey,unwrapKey:"function"==typeof window.crypto.subtle.unwrapKey},e.methodCount=Object.values(e.methods).filter(Boolean).length}return e}catch(e){return{error:"not_supported"}}}async function w(){try{if(!("serviceWorker"in navigator))return{error:"not_supported"};const e={serviceWorkerSupported:!0,scope:"",registrations:[],controller:null};try{const t=await navigator.serviceWorker.getRegistrations();return e.registrations=t.map((e=>({scope:e.scope,active:!!e.active,installing:!!e.installing,waiting:!!e.waiting,updateViaCache:e.updateViaCache||"none"}))),e.registrationCount=t.length,navigator.serviceWorker.controller&&(e.controller={scriptURL:navigator.serviceWorker.controller.scriptURL,state:navigator.serviceWorker.controller.state}),e.capabilities={register:"function"==typeof navigator.serviceWorker.register,getRegistration:"function"==typeof navigator.serviceWorker.getRegistration,getRegistrations:"function"==typeof navigator.serviceWorker.getRegistrations,addEventListener:"function"==typeof navigator.serviceWorker.addEventListener,ready:!!navigator.serviceWorker.ready},e}catch(e){return{serviceWorkerSupported:!0,error:"access_denied",capabilities:{register:"function"==typeof navigator.serviceWorker.register,getRegistration:"function"==typeof navigator.serviceWorker.getRegistration,getRegistrations:"function"==typeof navigator.serviceWorker.getRegistrations}}}}catch(e){return{error:"not_supported"}}}function y(){return new Promise((e=>{try{const t=[];"DeviceOrientationEvent"in window&&t.push("DeviceOrientationEvent"),"DeviceMotionEvent"in window&&t.push("DeviceMotionEvent"),"Accelerometer"in window&&t.push("Accelerometer"),"Gyroscope"in window&&t.push("Gyroscope"),"Magnetometer"in window&&t.push("Magnetometer"),"AmbientLightSensor"in window&&t.push("AmbientLightSensor"),"ProximitySensor"in window&&t.push("ProximitySensor"),navigator.permissions?navigator.permissions.query({name:"accelerometer"}).then((n=>{e({availableSensors:t,accelerometerPermission:n.state})})).catch((()=>{e({availableSensors:t,accelerometerPermission:"denied"})})):e({availableSensors:t,accelerometerPermission:"unknown"})}catch(t){e({error:"not_supported"})}}))}function v(){try{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)return{error:"not_supported"};const n=t.getExtension("WEBGL_debug_renderer_info");if(!n)return{error:"no_debug_info"};const r=t.getParameter(t.VENDOR),i=t.getParameter(t.RENDERER),o=t.getParameter(t.VERSION);return{vendor:r,renderer:i,version:o,unmaskedRenderer:t.getParameter(n.UNMASKED_RENDERER_WEBGL)}}catch(e){return{error:"error"}}}function f(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.sampleRate,n=e.state,r=e.createOscillator(),i=e.createAnalyser();r.connect(i),i.connect(e.destination);const o=new Uint8Array(i.frequencyBinCount);i.getByteFrequencyData(o);return{sampleRate:t,state:n,frequencyData:Array.from(o.slice(0,5))}}catch(e){return{error:"not_supported"}}}async function m(){try{if(navigator.getBattery){return{charging:(await navigator.getBattery()).charging}}return{error:"not_supported"}}catch(e){return{error:"error"}}}async function S(e=null){try{const t=[{url:"https://ipinfo.io/json",timeout:1e3,priority:1},{url:"https://ipapi.co/json/",timeout:1500,priority:2},{url:"https://ip.guide/",timeout:1e3,priority:3}].filter((e=>o(e.url))),n={ip:"unknown",country:"unknown",region:"unknown",city:"unknown",isp:"unknown",timezone:"unknown"},r=localStorage.getItem("lastIPAPICall"),s=Date.now();if(r&&s-parseInt(r)<5e3)return{error:"rate_limited"};const a=t.map((async e=>{try{const t=new AbortController,n=setTimeout((()=>t.abort()),e.timeout),r=await fetch(e.url,{signal:t.signal,headers:{Accept:"application/json"}});if(clearTimeout(n),!r.ok)throw new Error(`HTTP ${r.status}`);const i=await r.json();if(!i||"object"!=typeof i)throw new Error("Invalid response format");return{success:!0,data:i,priority:e.priority,source:e.url}}catch(t){return{success:!1,error:t.message,priority:e.priority,source:e.url}}})),c=(await Promise.allSettled(a)).filter((e=>"fulfilled"===e.status&&e.value.success)).map((e=>e.value)).sort(((e,t)=>e.priority-t.priority));if(c.length>0){const e=c[0].data;n.ip=i(e.ip||e.query||"unknown"),n.country=i(e.country||e.country_name||"unknown"),n.region=i(e.region||e.regionName||"unknown"),n.city=i(e.city||"unknown"),n.isp=i(e.org||e.isp||e.network?.autonomous_system?.name||"unknown"),n.timezone=i(e.timezone||"unknown"),localStorage.setItem("lastIPAPICall",s.toString())}return"Firefox"===e?{ip:n.ip,timezone:n.timezone}:n}catch(e){return{error:"not_supported"}}}async function b(){if(void 0===e)throw new Error("ClientJS is not available");const t=new e,n={userAgent:t.getUserAgent(),userAgentLowerCase:t.getUserAgentLowerCase(),browser:t.getBrowser(),browserVersion:t.getBrowserVersion(),browserMajorVersion:t.getBrowserMajorVersion(),engine:t.getEngine(),engineVersion:t.getEngineVersion(),os:t.getOS(),osVersion:t.getOSVersion(),device:t.getDevice(),deviceType:t.getDeviceType(),deviceVendor:t.getDeviceVendor(),cpu:t.getCPU(),screenPrint:t.getScreenPrint(),colorDepth:t.getColorDepth(),currentResolution:t.getCurrentResolution(),availableResolution:t.getAvailableResolution(),deviceXDPI:t.getDeviceXDPI(),deviceYDPI:t.getDeviceYDPI(),timezone:t.getTimeZone(),language:t.getLanguage(),systemLanguage:t.getSystemLanguage(),sessionStorage:t.isSessionStorage(),localStorage:t.isLocalStorage(),cookies:t.isCookie(),plugins:a(t.getPlugins()),mimeTypes:a(t.getMimeTypes()),isMimeTypes:t.isMimeTypes(),java:t.isJava(),flash:t.isFlash(),silverlight:t.isSilverlight(),silverlightVersion:t.getSilverlightVersion(),fonts:a(t.getFonts()).replace("GungSeo",""),canvas:t.isCanvas(),canvasPrint:t.getCanvasPrint(),isMobile:t.isMobile(),isMobileMajor:t.isMobileMajor(),isMobileAndroid:t.isMobileAndroid(),isMobileOpera:t.isMobileOpera(),isMobileWindows:t.isMobileWindows(),isMobileBlackBerry:t.isMobileBlackBerry(),isMobileIOS:t.isMobileIOS(),isIphone:t.isIphone(),isIpad:t.isIpad(),isIpod:t.isIpod(),isIE:t.isIE(),isChrome:t.isChrome(),isFirefox:t.isFirefox(),isSafari:t.isSafari(),isOpera:t.isOpera(),isWindows:t.isWindows(),isMac:t.isMac(),isLinux:t.isLinux(),isUbuntu:t.isUbuntu(),isSolaris:t.isSolaris()},r={devicePixelRatio:window.devicePixelRatio||1,hardwareConcurrency:navigator.hardwareConcurrency||"unknown",deviceMemory:navigator.deviceMemory||"unknown",maxTouchPoints:navigator.maxTouchPoints||0,pointerEnabled:navigator.pointerEnabled||!1,msMaxTouchPoints:navigator.msMaxTouchPoints||0,doNotTrack:navigator.doNotTrack||"unknown",cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,userAgentData:navigator.userAgentData||"not_supported",webdriver:navigator.webdriver||!1,permissions:navigator.permissions?"supported":"not_supported",mediaDevices:navigator.mediaDevices?"supported":"not_supported",geolocation:navigator.geolocation?"supported":"not_supported",battery:navigator.getBattery?"supported":"not_supported",connectionType:navigator.connection&&navigator.connection.effectiveType||"unknown",webglFingerprint:JSON.stringify(v()),audioFingerprint:JSON.stringify(f()),batteryFingerprint:JSON.stringify(await m()),timezoneOffset:(new Date).getTimezoneOffset(),ipFingerprint:JSON.stringify(await S(n.browser)),webrtcFingerprint:JSON.stringify(await c()),cssMediaFingerprint:JSON.stringify(g()),gamepadFingerprint:JSON.stringify(u()),indexedDBFingerprint:JSON.stringify(await l()),networkFingerprint:JSON.stringify(p()),sensorFingerprint:JSON.stringify(await y()),speechSynthesisFingerprint:JSON.stringify(d()),cryptoAPIFingerprint:JSON.stringify(h()),serviceWorkerFingerprint:JSON.stringify(await w())};let i={...n,...r};if(delete i.fingerprint,function(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)&&e.brands.some((e=>"Brave"===e.brand))}()){if(delete i.availableResolution,delete i.audioFingerprint,i.enhancedCanvasFingerprint&&i.enhancedCanvasFingerprint.dataURL&&i.enhancedCanvasFingerprint.dataURL.startsWith("data:image/png;base64,")){const e=i.enhancedCanvasFingerprint.dataURL.substring(22);i.enhancedCanvasFingerprint.dataURL="data:image/png;base64,"+e.substring(0,64)}delete i.currentResolution,delete i.hardwareConcurrency,delete i.deviceMemory,delete i.canvasPrint,delete i.plugins}else if("Safari"===i.browser){if(delete i.availableResolution,delete i.canvasPrint,delete i.currentResolution,delete i.screenPrint,i.enhancedCanvasFingerprint&&i.enhancedCanvasFingerprint.dataURL&&i.enhancedCanvasFingerprint.dataURL.startsWith("data:image/png;base64,")){const e=i.enhancedCanvasFingerprint.dataURL.substring(22);i.enhancedCanvasFingerprint.dataURL="data:image/png;base64,"+e.substring(0,128)}}else"Firefox"===i.browser?(delete i.canvasPrint,delete i.fonts,delete i.doNotTrack):"Opera"===i.browser?(delete i.languageFingerprint,delete i.windowOuterWidth,delete i.windowInnerWidth):"Edge"===i.browser?(delete i.languageFingerprint,delete i.speechSynthesisFingerprint):"Chrome"===i.browser&&(delete i.mediaDevicesFingerprint,delete i.languageFingerprint,delete i.windowInnerWidth,delete i.windowOuterWidth);return i}function k(){return window.crypto&&window.crypto.subtle?"SHA-256":"SimpleHash"}return r.checkConsent(),{getUniqueVisitorId:async function(){const e=await b(),t=Object.values(e).join("|"),n=await s(t),r=function(e){let t=0,n=0,r=[],i=[];const o={userAgent:{weight:8,check:e=>e.userAgent&&e.userAgent.length>10},browser:{weight:6,check:e=>e.browser&&"unknown"!==e.browser},browserVersion:{weight:4,check:e=>e.browserVersion&&"unknown"!==e.browserVersion},engine:{weight:5,check:e=>e.engine&&"unknown"!==e.engine},os:{weight:7,check:e=>e.os&&"unknown"!==e.os},osVersion:{weight:3,check:e=>e.osVersion&&"unknown"!==e.osVersion},hardwareConcurrency:{weight:6,check:e=>e.hardwareConcurrency&&"unknown"!==e.hardwareConcurrency&&e.hardwareConcurrency>0},deviceMemory:{weight:6,check:e=>e.deviceMemory&&"unknown"!==e.deviceMemory&&e.deviceMemory>0},devicePixelRatio:{weight:4,check:e=>e.devicePixelRatio&&e.devicePixelRatio>0},maxTouchPoints:{weight:3,check:e=>void 0!==e.maxTouchPoints},screenPrint:{weight:5,check:e=>e.screenPrint&&e.screenPrint.length>5},colorDepth:{weight:3,check:e=>e.colorDepth&&e.colorDepth>0},currentResolution:{weight:4,check:e=>e.currentResolution&&e.currentResolution.length>5},availableResolution:{weight:4,check:e=>e.availableResolution&&e.availableResolution.length>5},canvasPrint:{weight:8,check:e=>e.canvasPrint&&e.canvasPrint.length>50},canvas:{weight:2,check:e=>!0===e.canvas},plugins:{weight:6,check:e=>e.plugins&&e.plugins.split(", ").length>2},mimeTypes:{weight:4,check:e=>e.mimeTypes&&e.mimeTypes.split(", ").length>1},fonts:{weight:7,check:e=>e.fonts&&e.fonts.split(", ").length>10},language:{weight:4,check:e=>e.language&&"unknown"!==e.language},systemLanguage:{weight:3,check:e=>e.systemLanguage&&"unknown"!==e.systemLanguage},timezone:{weight:5,check:e=>e.timezone&&"unknown"!==e.timezone},timezoneOffset:{weight:3,check:e=>void 0!==e.timezoneOffset},localStorage:{weight:2,check:e=>!0===e.localStorage},sessionStorage:{weight:2,check:e=>!0===e.sessionStorage},cookies:{weight:2,check:e=>!0===e.cookies},webglFingerprint:{weight:8,check:e=>{try{const t=JSON.parse(e.webglFingerprint||"{}");return t.vendor&&t.renderer&&!t.error}catch{return!1}}},audioFingerprint:{weight:7,check:e=>{try{const t=JSON.parse(e.audioFingerprint||"{}");return t.sampleRate&&!t.error}catch{return!1}}},webrtcFingerprint:{weight:6,check:e=>{try{const t=JSON.parse(e.webrtcFingerprint||"{}");return t.localIPs&&t.localIPs.length>0&&!t.error}catch{return!1}}},cssMediaFingerprint:{weight:5,check:e=>{try{const t=JSON.parse(e.cssMediaFingerprint||"{}");return"object"==typeof t&&Object.keys(t).length>5&&!t.error}catch{return!1}}},speechSynthesisFingerprint:{weight:6,check:e=>{try{const t=JSON.parse(e.speechSynthesisFingerprint||"{}");return t.voicesLoaded&&t.voiceCount>0&&!t.error}catch{return!1}}},cryptoAPIFingerprint:{weight:5,check:e=>{try{const t=JSON.parse(e.cryptoAPIFingerprint||"{}");return t.cryptoSupported&&t.algorithms&&t.algorithms.length>0&&!t.error}catch{return!1}}},serviceWorkerFingerprint:{weight:4,check:e=>{try{const t=JSON.parse(e.serviceWorkerFingerprint||"{}");return t.serviceWorkerSupported&&!t.error}catch{return!1}}},networkFingerprint:{weight:3,check:e=>{try{const t=JSON.parse(e.networkFingerprint||"{}");return t.effectiveType&&!t.error}catch{return!1}}},ipFingerprint:{weight:7,check:e=>{try{const t=JSON.parse(e.ipFingerprint||"{}");return t.ip&&"unknown"!==t.ip&&!t.error}catch{return!1}}},isMobile:{weight:3,check:e=>void 0!==e.isMobile},deviceType:{weight:4,check:e=>e.deviceType&&"unknown"!==e.deviceType},deviceVendor:{weight:3,check:e=>e.deviceVendor&&"unknown"!==e.deviceVendor}};Object.entries(o).forEach((([o,s])=>{n+=s.weight,e.hasOwnProperty(o)?s.check(e)?(t+=s.weight,i.push(`${o}: Available (+${s.weight})`)):r.push(`${o}: Invalid or spoofed data`):r.push(`${o}: Missing (browser limitation)`)})),"1"===e.doNotTrack&&(t=Math.max(0,t-5),r.push("Do Not Track enabled (-5)")),!0===e.webdriver&&(t=Math.max(0,t-10),r.push("WebDriver detected (-10)")),"Chrome"===e.browser&&(!e.plugins||e.plugins.length<10)&&(!e.mimeTypes||e.mimeTypes.length<10)&&(t=Math.max(0,t-5),r.push("Possible Brave browser privacy restrictions (-5)"));const s=n>0?Math.round(t/n*100):0;let a="Very Low";return a=s>=90?"Very High":s>=75?"High":s>=60?"Medium":s>=45?"Low":"Very Low",{score:s,level:a,deductions:r,details:i.slice(0,10),rawScore:t,maxPossibleScore:n,dataPointsAvailable:Object.keys(e).length,fingerprintingTechniques:{core:Math.round(t/n*100*.4),advanced:Math.round(t/n*100*.6)}}}(e);let i=e.timezone,o={};try{o=JSON.parse(e.ipFingerprint||"{}")}catch(e){o={error:"parse_error"}}return{uniqueVisitorId:n,confidence:r,timezone:i,ipData:o,hashMethod:k()}},getStableDeviceData:b,getAllDeviceData:async function(){return{...await b(),...{windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,screenAvailWidth:screen.availWidth,screenAvailHeight:screen.availHeight,screenWidth:screen.width,screenHeight:screen.height}}},getHashMethod:k,generateWebGLFingerprint:v,generateAudioFingerprint:f,generateBatteryFingerprint:m,generateIPFingerprint:S,generateWebRTCFingerprint:c,generateCSSMediaQueriesFingerprint:g,generateGamepadFingerprint:u,generateIndexedDBFingerprint:l,generateNetworkFingerprint:p,generateSensorFingerprint:y,generateSpeechSynthesisFingerprint:d,generateCryptoAPIFingerprint:h,generateServiceWorkerFingerprint:w,giveConsent:r.giveConsent.bind(r),revokeConsent:r.revokeConsent.bind(r),getConsentStatus:r.getConsentStatus.bind(r),validateAndSanitizeInput:i,isValidURL:o}}));